<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<style>
body{font-family:"Prompt",sans-serif; margin:0; background:#f4f6f9;}
header{background:#007bff;color:white;padding:15px 25px; display:flex; justify-content:space-between; align-items:center;}
header h1{margin:0;font-size:1.3rem;}
.header-right{display:flex; align-items:center; gap:15px;}
.user-info{font-weight:bold;}
#logout-btn{background:#ff4d4d;border:none;color:white;padding:8px 15px;border-radius:6px;cursor:pointer; transition:.3s;}
#logout-btn:hover{background:#e60000;}
.dashboard{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; padding:30px;}
.card{background:white;border-radius:12px;box-shadow:0 2px 6px rgba(0,0,0,0.1);padding:25px;text-align:center;font-size:1.1rem;font-weight:500;cursor:pointer;transition:.3s;}
.card:hover{background:#007bff;color:white; transform:translateY(-4px);}
#form-section{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.4);display:none;justify-content:center;align-items:center;z-index:1000;}
#form-section.show{display:flex;}
.form-box{background:white; padding:25px;border-radius:12px;width:90%;max-width:700px; box-shadow:0 5px 15px rgba(0,0,0,0.3); position:relative;animation:fadeIn .3s ease; overflow-y:auto; max-height:85vh;}
.close-btn{position:absolute;top:10px; right:15px; font-size:1.5rem; cursor:pointer; color:#666; transition:.3s;}
.close-btn:hover{color:red;}
.form-box input, .form-box select, .form-box button{width:100%; padding:10px; margin:8px 0; font-size:1rem;}
.form-box button{background:#007bff; border:none;color:white;border-radius:6px; cursor:pointer; transition:.3s;}
.form-box button:hover{background:#0056b3;}
table{width:100%; border-collapse:collapse; margin-top:10px;}
th,td{border:1px solid #ccc; padding:8px; text-align:center;}
th{background:#007bff;color:white;}
@keyframes fadeIn{from{opacity:0; transform:translateY(-10px);} to{opacity:1; transform:translateY(0);}}
</style>
</head>
<body>

<header>
<h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå (Admin)</h1>
<div class="header-right">
  <div class="user-info">üë§ <span id="username">Admin</span></div>
  <button id="logout-btn" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>
</header>

<main class="dashboard">
<div class="card" onclick="openForm('add')">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</div>
<div class="card" onclick="openForm('edit')">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</div>
<div class="card" onclick="openForm('wait')">üïì ‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
<div class="card" onclick="openForm('report')">üìä ‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå</div>
<div class="card" onclick="openForm('list')">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
<div class="card" onclick="openForm('manual')">üìò ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</div>
<div class="card" onclick="openForm('user')">üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</div>
</main>

<section id="form-section">
<div class="form-box">
  <span class="close-btn" onclick="closeForm()">√ó</span>
  <h2 id="form-title">‡∏ü‡∏≠‡∏£‡πå‡∏°</h2>
  <div id="form-content"></div>
</div>
</section>

<script>
document.getElementById("username").textContent = localStorage.getItem("username")||"Admin";

// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏õ‡πá‡∏ô URL Web App ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
const SHEET_URL = {
  DATA: "https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?sheet=DATA",
  WAIT: "https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?sheet=WAIT",
  SHOW: "https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?sheet=SHOW",
  LOGIN: "https://script.google.com/macros/s/YOUR_DEPLOY_ID/exec?sheet=LOGIN"
};

const formSection = document.getElementById("form-section");
const formTitle = document.getElementById("form-title");
const formContent = document.getElementById("form-content");

function openForm(type){
  formSection.classList.add("show");
  formContent.innerHTML="";

  switch(type){
    case 'add':
      formTitle.textContent="‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";
      formContent.innerHTML=`
        <label>‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå:</label><input type="text" id="code">
        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå:</label><input type="text" id="name">
        <button onclick="saveData()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>`;
      break;
    case 'edit':
      formTitle.textContent="‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";
      loadData('DATA',true);
      break;
    case 'wait':
      formTitle.textContent="üïì ‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö";
      loadData('WAIT');
      break;
    case 'report':
      formTitle.textContent="üìä ‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå";
      formContent.innerHTML=`
        <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ:</label>
        <input type="month" id="month">
        <button onclick="loadReport()">‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
        <div id="report-result"></div>`;
      break;
    case 'list':
      formTitle.textContent="üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î";
      loadData('DATA');
      break;
    case 'manual':
      formTitle.textContent="üìò ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
      formContent.innerHTML=`
        <p>1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå ‚Üí ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
        <p>2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</p>
        <p>3. ‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‚Üí ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô</p>
        <p>4. ‡∏≠‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>
        <p>5. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å ‚Üí ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö</p>`;
      break;
    case 'user':
      formTitle.textContent="üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å";
      loadData('LOGIN');
      break;
  }
}

function closeForm(){ formSection.classList.remove("show"); }
formSection.addEventListener("click", e=>{ if(e.target===formSection) closeForm(); });
function logout(){ localStorage.removeItem("username"); window.location.href="login.html"; }

function loadData(sheet,edit=false){
  fetch(SHEET_URL[sheet])
    .then(res=>res.json())
    .then(data=>{
      if(!Array.isArray(data)||data.length===0){ formContent.innerHTML="<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>"; return; }
      let table="<table><tr>";
      Object.keys(data[0]).forEach(key=>table+=`<th>${key}</th>`);
      if(edit) table+="<th>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</th>";
      table+="</tr>";
      data.forEach((row,i)=>{
        table+="<tr>";
        Object.values(row).forEach(val=>table+=`<td>${val}</td>`);
        if(edit) table+=`<td><button onclick="editItem(${i})">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button></td>`;
        table+="</tr>";
      });
      table+="</table>";
      formContent.innerHTML=table;
    })
    .catch(()=>formContent.innerHTML="<p style='color:red;'>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</p>");
}

function saveData(){
  const code=document.getElementById("code").value.trim();
  const name=document.getElementById("name").value.trim();
  if(!code||!name){ alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö"); return; }
  fetch(SHEET_URL.DATA,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({"‡∏£‡∏´‡∏±‡∏™‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå":code,"‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏∏‡∏†‡∏±‡∏ì‡∏ë‡πå":name})
  }).then(res=>res.json())
    .then(()=>{ alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"); closeForm(); })
    .catch(()=>alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å"));
}

function editItem(index){ alert("‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà index: "+index+" ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"); }

function loadReport(){
  const month=document.getElementById("month").value;
  if(!month){ alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô"); return; }
  const reportDiv=document.getElementById("report-result");
  reportDiv.innerHTML="<p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô...</p>";
  fetch(SHEET_URL.SHOW+"&month="+month)
    .then(res=>res.json())
    .then(data=>{
      if(!Array.isArray(data)||data.length===0){ reportDiv.innerHTML="<p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>"; return; }
      let table="<table><tr>";
      Object.keys(data[0]).forEach(k=>table+=`<th>${k}</th>`);
      table+="</tr>";
      data.forEach(row=>{ table+="<tr>"+Object.values(row).map(v=>`<td>${v}</td>`).join("")+"</tr>"; });
      table+="</table>";
      reportDiv.innerHTML=table;
    })
    .catch(()=>reportDiv.innerHTML="<p style='color:red;'>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</p>");
}
</script>

</body>
</html>
